# üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Tanzu Kubernetes –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö

> **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è Tanzu Kubernetes –∫–ª–∞—Å—Ç–µ—Ä–∞ —Å —Ç–µ–º –∂–µ –∏–º–µ–Ω–µ–º, kubectl –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É `You must be logged in to the server (Unauthorized)` –¥–∞–∂–µ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `kubectl vsphere login`.

## üìã –°–∏–º–ø—Ç–æ–º—ã –ø—Ä–æ–±–ª–µ–º—ã

```bash
$ kubectl vsphere login --server <IP> --tanzu-kubernetes-cluster-name <cluster-name> -u <user>
# –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ

$ kubectl get ns
error: You must be logged in to the server (Unauthorized)
```

## üîç –ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã

–ü—Ä–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ —Å —Ç–µ–º –∂–µ –∏–º–µ–Ω–µ–º:
- **Kubernetes API Server –ø–æ–ª—É—á–∞–µ—Ç –Ω–æ–≤—ã–µ TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã**
- **kubectl –∫–µ—à–∏—Ä—É–µ—Ç —Å—Ç–∞—Ä—ã–µ —Ç–æ–∫–µ–Ω—ã** –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞
- **kubectl vsphere login –Ω–µ –≤—Å–µ–≥–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç** –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ credentials
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç –æ—Å—Ç–∞–µ—Ç—Å—è —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏**

## ‚úÖ –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞
```bash
# –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ supervisor cluster namespace
kubectl config use-context <supervisor-namespace>

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∫–ª–∞—Å—Ç–µ—Ä –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≥–æ—Ç–æ–≤
kubectl get tanzukubernetescluster <cluster-name> -n <namespace> -o wide
```

**–ß—Ç–æ –∏—â–µ–º:**
- `READY: True`
- `CONTROL PLANE: X` (–Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
- `WORKER: Y` (–Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)

### –®–∞–≥ 2: –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ API Endpoint
```bash
kubectl get tanzukubernetescluster <cluster-name> -n <namespace> \
  -o jsonpath='{.status.apiEndpoints[0].host}:{.status.apiEndpoints[0].port}'
```

**–ó–∞—á–µ–º:** –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ IP –∞–¥—Ä–µ—Å –∫–ª–∞—Å—Ç–µ—Ä–∞ –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è.

### –®–∞–≥ 3: –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
```bash
# –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏
kubectl config delete-context <cluster-name>
```

**–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ:** –°—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –æ—Ç —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞.

### –®–∞–≥ 4: –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ kubeconfig
```bash
# –ü–æ–ª—É—á–∞–µ–º fresh kubeconfig –Ω–∞–ø—Ä—è–º—É—é –∏–∑ Kubernetes —Å–µ–∫—Ä–µ—Ç–∞
kubectl get secret <cluster-name>-kubeconfig -n <namespace> \
  -o jsonpath='{.data.value}' | base64 -d > temp-kubeconfig.yaml
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:** –°–µ–∫—Ä–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∏ —Ç–æ–∫–µ–Ω—ã –Ω–æ–≤–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞.

### –®–∞–≥ 5: –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
```bash
# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ –ø–æ–Ω—è—Ç–Ω–æ–µ –∏–º—è
kubectl --kubeconfig=temp-kubeconfig.yaml config rename-context \
  $(kubectl --kubeconfig=temp-kubeconfig.yaml config current-context) \
  <cluster-name>
```

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
```bash
# –¢–µ—Å—Ç–∏—Ä—É–µ–º —á—Ç–æ –Ω–æ–≤—ã–π kubeconfig —Ä–∞–±–æ—Ç–∞–µ—Ç
kubectl --kubeconfig=temp-kubeconfig.yaml get ns
kubectl --kubeconfig=temp-kubeconfig.yaml get nodes
```

**–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:** –°–ø–∏—Å–æ–∫ namespaces –∏ —É–∑–ª–æ–≤ –±–µ–∑ –æ—à–∏–±–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

### –®–∞–≥ 7: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π kubeconfig
```bash
# –°–æ–∑–¥–∞–µ–º backup —Ç–µ–∫—É—â–µ–≥–æ kubeconfig
cp ~/.kube/config ~/.kube/config.backup

# –û–±—ä–µ–¥–∏–Ω—è–µ–º —Å—Ç–∞—Ä—ã–π kubeconfig —Å –Ω–æ–≤—ã–º —Ä–∞–±–æ—á–∏–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
KUBECONFIG=~/.kube/config.backup:temp-kubeconfig.yaml \
  kubectl config view --flatten > merged-config.yaml

# –ó–∞–º–µ–Ω—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π kubeconfig
cp merged-config.yaml ~/.kube/config
```

### –®–∞–≥ 8: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```bash
# –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä
kubectl config use-context <cluster-name>

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
kubectl get ns
kubectl get nodes
```

### –®–∞–≥ 9: –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
```bash
rm temp-kubeconfig.yaml merged-config.yaml ~/.kube/config.backup
```

## üöÄ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–±

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å —Å –∫–ª–∞—Å—Ç–µ—Ä–æ–º:

```bash
# –ü–æ–ª—É—á–∞–µ–º kubeconfig –∏ —Ä–∞–±–æ—Ç–∞–µ–º —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥
kubectl get secret <cluster-name>-kubeconfig -n <namespace> \
  -o jsonpath='{.data.value}' | base64 -d > cluster-kubeconfig.yaml

# –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞–ø—Ä—è–º—É—é
kubectl --kubeconfig=cluster-kubeconfig.yaml get ns
kubectl --kubeconfig=cluster-kubeconfig.yaml get pods
```

## üìù –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –û–±–Ω–æ–≤–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–ª–æ–≥–∏–Ω–∞
–î–æ–±–∞–≤—å—Ç–µ –≤–∞—à –∫–ª–∞—Å—Ç–µ—Ä –≤ `Login-AllClusters.ps1`:

```powershell
$clusters = @(
    # ... existing clusters ...
    @{ Server = "<supervisor-ip>"; Namespace = "<namespace>"; Name = "<cluster-name>" }
)
```

### 2. –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è
```bash
# –ü–æ—Å–ª–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∞ –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ:
kubectl get tanzukubernetescluster <cluster-name> -n <namespace>
kubectl describe tanzukubernetescluster <cluster-name> -n <namespace>
```

### 3. –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
–°–Ω–∞—á–∞–ª–∞ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–ª—É—á–∏—Ç—å kubeconfig –∏–∑ —Å–µ–∫—Ä–µ—Ç–∞ - —ç—Ç–æ —Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π —Å–ø–æ—Å–æ–±.

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ kubectl vsphere login** —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∞ - –ª—É—á—à–µ –ø–æ–ª—É—á–∏—Ç—å kubeconfig –∏–∑ —Å–µ–∫—Ä–µ—Ç–∞
2. **–í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π—Ç–µ backup** ~/.kube/config –ø–µ—Ä–µ–¥ –≤–Ω–µ—Å–µ–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π
3. **IP –∞–¥—Ä–µ—Å –∫–ª–∞—Å—Ç–µ—Ä–∞ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è** –ø—Ä–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–∏ - –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π endpoint
4. **–î–æ–∂–¥–∏—Ç–µ—Å—å –ø–æ–ª–Ω–æ–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏** –∫–ª–∞—Å—Ç–µ—Ä–∞ (READY: True) –ø–µ—Ä–µ–¥ –ø–æ–ø—ã—Ç–∫–∞–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

## üéØ –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:
- ‚úÖ –†–∞–±–æ—á–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–ª–∞—Å—Ç–µ—Ä–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º kubeconfig
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏ —á–µ—Ä–µ–∑ `kubectl config use-context`
- ‚úÖ –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∫–ª–∞—Å—Ç–µ—Ä—É –±–µ–∑ –æ—à–∏–±–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤

---

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~5-10 –º–∏–Ω—É—Ç
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** –î–æ—Å—Ç—É–ø –∫ supervisor cluster –∏ –ø—Ä–∞–≤–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤
